## 영속성 관리 - 내부 동작 방식

### JPA에서 가장 중요 2가지

- 객체와 관계형 디비 매핑
- 영속성 컨텍스트



 1차 캐시

동일성 보장

트랜잭션을 지원하는 쓰기 지연

변경 감지

지연 로딩



---

플러시 - DB에 쿼리문을 날림

변경 감지

수정된 엔티티 SQL 저장소에 등록

1차 캐시 안사라지고, DB에 반영만 된다. -> 영속성 컨텍스트를 비유지 않음

트랜잭션이라는 작업 단위가 중요 -> 커밋 직전에만 동기화 하면 됨



---

준영속 상태

영속 -> 준영속

영속: em.find 하고 영속성 컨텍스트에 없을 경우 db에서 가져옴

준영속을 만들 때 em.detach()

