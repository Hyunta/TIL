# 문제 상황

- 매일 1억개의 단축 URL

# 개략적인 설계안

1. API endPoint 설계

   - url 단축용 엔드포인트:

     POST 로 해당 인자를 보내면 단축 url을 반환한다.

     POST /api/v1/data/shorten

     body: [longUrl: longURLString]

   - url 리디렉션용 엔드포인트

     GET 요청을 보내면 HTTP 리디렉션 목적지가 될 원래 URL

     GET api/v1/shorturl

     return: 원래 URL

2. URL 리디렉션

   1. 클라이언트가 단축 URL로 요청을 보낸다.
   2. 단축용 서버에서 301 응답으로 원래 Location을 반환한다.
   3. 원래 URL에 방문한다.

   - 301 (Permanently Moved) : 영구적으로 이동됐다는 말로 브라우저는 응답을 캐시에 저장한다.

     서버 부하를 줄일 수 있다.

   - 302 (Found) : 일시적으로 옮겨졌다는 의미로 클라이언트 요청은 항상 단축 서버에 보내진 후에 원래 URL로 리디렉션 된다.

     매번 요청이 오기 때문에 트래픽을 분석하기 유리하다. 클릭 발생률이나 발생위치 추적 용이

 3. URL 단축

    입력으로 주어지는 긴 url이 다르면 해싱값도 달라야한다.

    계산된 해시값은 복구 가능해야한다.



## 전반적인 흐름

1. 입력

2. 입력된 값이 db에 있는지 확인한다.

   (없을 경우)

   1. 아이디 생성
   2. 생성된 id를 단축 url로 변환
   3. id, 단축 url, 원래 url을 db에 저장

   (있을 경우)

   1. db에서 찾은 단축 url 반환