# 2주차 후기

1. 클래스 분리와 함수 분리
2. 예외 처리
3. 메세지, 상수
4. 책임에 대하여

---

## 1. 클래스 분리와 함수 분리

1주차를 마치고 같이 제출하신 분들의 코드를 읽어보았다. 구현을 해본 코드라서 다른 분들의 코드를 이해하기 쉬웠다. 정말 배울점이 많았고 그 중에 바로 도입해야겠다고 생각한 것이 패키지의 구조였다. 클린코드의 함수와 객체 부분을 읽으며 얼마나 분리해야하나 고민을 했는데, 답을 구할 수 있었다.

> 함수는 한 가지를 해야 한다. 그 한 가지를 잘해야 한다. 그 한가지 만을 해야한다.

최대한 작게 만들고 함수가 하나의 기능만을 하도록 만들라고 하였고, 이 말은 즉 단 한개의 책임을 가져야한다는 말이다. 책임이라는 말이 애매하기 때문에 저자는 변경이 있을 때 파급 효과가 적도록 구현하라고 하였다.

SOLID의 제일 앞글자를 담당하는 Single Responsibility Principle(단일 책임 원칙) 을 지키며 구현하는 것이 나의 2주차 목표였다.

처음 난간에 봉착한 것은 자동차 이름 입력값을 검증하는 과정에서 였다. 

> 1. 입력값을 받는다.
> 2. 입력값이 조건에 부합한지 판단한다.
> 3. 조건에 부합하면 `ArrayList<String>` 를 반환한다.

Controller 에서 이 3가지 기능이 한번에 움직이길 바랐다. 그러다 보니 처음 구현을 했을 때 책임이 중구난방 뒤섞여있었다. 그런데 클린코드에서 변수명을 잘 지으면 문제를 해결할 실마리가 보인다해서 고민을 했다.

결과적으로, 나는 getProperName 이라는 함수명을 통해 검증은 nameValidator에게 책임을 위임하고 입력값을 갖고오는 책임을 InputView에 부여하고 Controller에게는 입력값에 관해 받아오기만 하면 되도록 설계했다.

클래스를 잘 분리하기 위해서 MVC 패턴을 도입해보려고 노력하고, 클래스 이름을 잘 지어보려고 했다. 처음에는 CarService를 이용해서 각 경기를 진행하고, 자동차 등록, 우승자를 찾아내는 기능들을 관리했었다. 하지만 조금 더 깔끔하게 관리를 하고 싶어서 찾아보다가 일급 클래스에 대해 찾아보게 되었다.

바로 이거다 싶어서 Cars 라는 객체를 만들고 경주에 관련된 메서드를 관리하도록 만들었더니 Controller에서 더 명확하게 어떤 일을 하는지 확인할 수 있었다.

reference:

https://jojoldu.tistory.com/412

---

## 2. 예외 처리

예외 처리에 관련된 부분도 클린코드에서 도움을 받을 수 있었다.

1주차에는 needBalls 라는 `boolean` 값을 flag 값으로 사용해서 while-do 구문을 이용했다. 그런데 이보다 try-catch 구문을 쓰는게 더 명확하고 깔끔하다는 내용을 보았다.

그래서 2주차에서는 예외처리를 validation 클래스를 생성하여 `boolean` 값을 return 하는 것이 아니라 예외를 발생시키고 예외를 InputView클래스에서 catch 해서 풀어갈 수 있도록 구현해보았다.

```java
public void validateNames(ArrayList<String> names) {
		isOnlyName(names);
    	...
	}

	private void isOnlyName(ArrayList<String> names) {
		if (names.size() == 1) {
			throw new IllegalArgumentException(ERROR_ONLY_NAME);
		}
	}
```

---

## 3. 메세지 상수 처리

1주차 때는 constant 패키지를 만들어서 오류 메세지, 출력 메세지, 상수를 한꺼번에 관리하는 클래스를 만들었었다. 다른 분들은 view 클래스를 만들어서 한번에 입출력을 관리하도록 구현했는데 이 방식이 깔끔해보였다. 메세지도 상단에서 바로 확인할 수 있고 입력과 출력을 클래스를 통해 구분할 수 있어서 좋아보였다.

상수를 따로 분리하는 것도 나쁘지는 않다고 생각하는데, 이번에는 입출력을 관리하는 클래스를 만들어서 구현하기로 했다.

----

## 4. 책임에 대하여

구현을 마치고 계속 리팩토링하면서 책임에 대한 부분이 고민이 많이 됐다. 단일 책임 원칙을 지키고 싶은데, 책임이라는 말도 모호하고 한가지라고 보는 관점이 다를 수 있어서 클린코드의 클래스, 함수 챕터를 여러번 반복해서 읽었다. 최대한 의미있게 클래스를 분리하고 싶어서 각 클래스가 하나의 책임을 가질 수 있도록 설계했다.

```
Car : 도메인 자동차 객체
CarService : 자동차 객체의 로직
RaceController : 애플리케이션 흐름 제어
InputView : 입력 관리
OutputView : 출력 관리
NameValidator : 이름 목록 검증
MoveCountValidator : 이동 횟수 검증
```

작성을 하고보니 CarService의 책임이 하나 이상이라고 봐야하나 의문이 든다. Controller와 Service를 조금 더 깔끔하게 구분하고 싶은데 아직까지는 방법을 잘 모르겠다. Car 객체를 다루는 방법도 서툴고 getter를 만들어서 접근할 수 있도록 만들기보다 좀 더 나은 방법은 없을까 고민을 계속 해봐야겠다.

---

